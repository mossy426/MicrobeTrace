<div class="bubble-wrapper">
    <div id="tool-btn-container" class="m-portlet">
        <span style="overflow: visible; position: relative; width: 110px;">
          <a title="Open Settings" class="btn btn-sm btn-clean btn-icon btn-icon-md" style="float:left" (click)="openSettings()"><i class="flaticon-settings primary"></i></a>
        </span>
        <span style="overflow: visible; position: relative; width: 110px;">
          <a title="Export Bubble Data" class="btn btn-sm btn-clean btn-icon btn-icon-md" style="float:left" (click)="openExport()"><i class="flaticon-download primary"></i></a>
        </span>
    </div>
    <div style="margin-top: 10px" id="bubbleViewContainer" [ngStyle]="{'height.px': viewHeight, 'width.px': viewWidth}">
        <vis-xy-container [data]="data" [padding]="padding">
            <vis-scatter #scatter [x]="x" [y]="y" [size]="sizing" [color]="color" [strokeColor]="strokeColor" [strokeWidth]="2"></vis-scatter>
            <vis-axis #x_axis type="x" [tickValues]="X_tickValues" [tickFormat]="X_axisFormat" [gridLine]="false" [label]="commonService.capitalize(xVariable)" [labelFontSize]="20" tickTextFontSize="20px"></vis-axis>
            <vis-axis #y_axis type="y" [tickValues]="Y_tickValues" [tickFormat]="Y_axisFormat" [gridLine]="false" [label]="commonService.capitalize(yVariable)" [labelFontSize]="20" tickTextFontSize="20px"></vis-axis>
            <vis-tooltip [triggers]="tooltipTriggers"></vis-tooltip>
        </vis-xy-container>
        <svg>
          <defs id="bubbleDefs">  
          </defs>
        </svg>
    </div>

    <p-dialog *ngIf="viewActive" [(visible)]="settingsOpen" header="Bubble Settings" [contentStyle]="{'max-height': '70vh', 'width': '600px'}" appendTo="body">
        <div class="form-group row" title="">
            <div class="col-3"><a>X</a></div>
            <div class="col-9">
              <p-dropdown [options]="selectedFieldList" [(ngModel)]="xVariable" (ngModelChange)="onDataChange()" appendTo="body"></p-dropdown>
            </div>
        </div>
        <div class="form-group row" title="">
          <div class="col-3"><a>Y</a></div>
          <div class="col-9">
            <p-dropdown [options]="selectedFieldList" [(ngModel)]="yVariable" (ngModelChange)="onDataChange()" appendTo="body"></p-dropdown>
          </div>
        </div>
        <div class="form-group row node-label-row" title="How big should the nodes be?">
          <div class="col-3"><label>Size</label></div>
          <div class="col-9"><input type="range" class="custom-range" min="10" step="1" max="40" [(ngModel)]="nodeSize" (change)="onNodeSizeChange()"></div>
        </div>
        <div class="form-group row node-label-row" title="How much space between nodes? This has no effect when nodes are collapsed.">
          <div class="col-3"><label>Spacing</label></div>
          <div class="col-9"><input type="range" class="custom-range" min=".01" step=".01" max=".15" [(ngModel)]="nodeSpacing" (change)="onNodeSpacingChange()"></div>
        </div>
        <div class="form-group row">
          <div class="col-3">Collapse</div>
          <div class="col-9">
              <p-selectButton [options]="NodeCollapsingTypes" [(ngModel)]="SelectedNodeCollapsingTypeVariable"
                  (ngModelChange)="onNodeCollapsingChange()"></p-selectButton>
          </div>
        </div>
        <div class="form-group row" title="">
            <div class="col-3"><label>Node Color</label></div>
            <button pButton type="button" label="Show Colors" class="ui-button-raised" (click)="showGlobalSettings()" style="margin-left: 15px;"></button>
        </div>
    </p-dialog>
  
    <p-dialog *ngIf="viewActive" [(visible)]="exportOpen" appendTo="body" header="Export Bubble View">
      <div class="modal-dialog" role="document">
          <div class="modal-content">
              <div class="modal-body" style='min-width: 400px; height: 100%;'>
                  <div class="form-group row">
                      <div class="col-9">
                          <input type="text" class="form-control form-control-sm" placeholder="Filename" [(ngModel)]="BubbleExportFileName">
                      </div>
                      <div class="col-3">
                          <select [(ngModel)]="BubbleExportFileType" class="form-control form-control-sm">
                              <option>svg</option>
                              <option>png</option>
                          </select>
                      </div>
                  </div>
                  <div [hidden]="BubbleExportFileType=='svg'">
                    <p-accordion>
                        <p-accordionTab style="color:#495057" header="Advanced">
                            <div id="network-export-advanced">
                                <div class="form-group row">
                                    <div class="col-3">
                                        <label for="network-export-scale">Scale</label>
                                    </div>
                                    <div class="col-9">
                                        <input type="number" class="form-control form-control-sm" min="0" max="2" step="0.1" [(ngModel)]="SelectedBubbleExportScaleVariable" (ngModelChange)="updateCalculatedResolution()">
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <div class="col-3">Resolution</div>
                                    <div id="network-export-dimensions" class="col-9 text-right">{{CalculatedResolution}}</div>
                                </div>
                            </div>
                        </p-accordionTab>
                    </p-accordion>
                </div>
              </div>
              <div class="modal-footer">
                  <button type="button" class="btn btn-error" (click)="exportOpen = false">Cancel</button>
                  <button type="button" class="btn btn-primary" (click)="exportVisualization()">Export</button>
              </div>
          </div><!-- /.modal-content -->
      </div><!-- /.modal-dialog -->
    </p-dialog><!-- /.modal -->

</div>